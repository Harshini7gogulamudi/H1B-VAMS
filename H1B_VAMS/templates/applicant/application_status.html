<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dynamic Application Progress</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
        background-color: #f8f9fa;
    }

     /* Header Styles */
     .header {
            background-color: #0056b3; /* Darker blue header */
            color: white;
            text-align: center;
            padding: 10px;
            border-bottom: 2px solid #0070c0; /* Accent border */
        }

        .header h1 {
            font-size: 1.75rem;
            margin: 0.5rem 0;
        }

    h2 {
        font-weight: bold;
    }

    .progress {
        background-color: #e9ecef;
        border-radius: 10px;
        overflow: hidden;
    }

    .progress-bar {
        font-weight: bold;
        font-size: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }
  </style>
</head>
<body>

    <div class="header">
        <h1>Welcome to H1B Application Portal for {{ employee_name }}</h1>
    </div>
    <div class="container my-5">
        <h2 class="mb-4">Application Progress</h2>

        <div id="progress-container" class="progress" style="height: 30px;">
            <!-- Progress bars will be inserted here by JS -->
        </div>

    </div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Fetch application status from Django
    // Example 1: Coming directly as a template variable (safe HTML escaping)
    const applicationStatus = "{{ application_status|escapejs }}";

    // Example 2: If you prefer fetching from an API (commented)
    // fetch('/api/application-status')
    //   .then(response => response.json())
    //   .then(data => {
    //     buildProgressBar(data.status);
    //   });

    buildProgressBar(applicationStatus);

    function buildProgressBar(status) {
      const container = document.getElementById('progress-container');
      container.innerHTML = ''; // Clear existing bars if any

      // Add 'Pending' and 'Under Review' by default
      container.appendChild(createProgressBar('Pending', 'bg-warning text-dark', 30));
      container.appendChild(createProgressBar('Under Review', 'bg-primary', 40));

      // Decide final stage
      if (status === "Approved") {
        container.appendChild(createProgressBar('Approved', 'bg-success', 30));
      } else if (status === "Rejected") {
        container.appendChild(createProgressBar('Rejected', 'bg-danger', 30));
      } else {
        container.appendChild(createProgressBar('In Progress', 'bg-secondary', 30)); // fallback
      }
    }

    function createProgressBar(label, classes, widthPercent) {
      const div = document.createElement('div');
      div.className = `progress-bar ${classes}`;
      div.setAttribute('role', 'progressbar');
      div.style.width = `${widthPercent}%`;
      div.textContent = label;
      return div;
    }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>